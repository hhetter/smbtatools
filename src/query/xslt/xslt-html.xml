<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet 
  version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns="http://www.w3.org/1999/xhtml">

<xsl:output method="xml" indent="yes" encoding="UTF-8"/>

<xsl:template match="usage">
	<h2>
	<xsl:value-of select="description"/>
	</h2>
	<table border="1" width="100%" rules="groups">
  	<colgroup>
    		<col width="65px"/>
    		<col width="60px"/>
    		<col width="150px"/>
		<col width="30px"/>
		
  	</colgroup>

	<tr>
	<th>Time</th>
	<th>Data Flow</th>
	<th>Graph</th>
	</tr>
	<xsl:apply-templates select="usagerow">
	</xsl:apply-templates>
	</table>
</xsl:template>



<xsl:template match="usagerow">
	<tr>
	<td><xsl:value-of select="time"/></td>
	<td><xsl:value-of select="convval"/></td>
	<td><image height="10" width="{percent}%" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oMFREBN2EEgkwAAAAdaVRYdENvbW1lbnQAAAAAAENyZWF0ZWQgd2l0aCBHSU1QZC5lBwAAAAxJREFUCNdjWPdYEQAD9QGzXlmXywAAAABJRU5ErkJggg=="/></td>
	<td><xsl:value-of select="percent"/>%</td>
	</tr>
</xsl:template>

<xsl:template match="last_activity">
	<h2>
	<xsl:value-of select="description"/>
	</h2>
	<table border="1" width="100%">
	<tr>
	<th>Timestamp</th>
	<th>VFS operation</th>
	<th>User</th>
	<th>File/Directory</th>
	<th>Domain</th>
	<th>Tranferred bytes</th>
	<th>Comment</th>
	<th>Other</th>
	</tr>
	<xsl:apply-templates select="last_activityrow">
	</xsl:apply-templates>
	</table>
</xsl:template>

<xsl:template match="last_activityrow">
	<tr>
	<td><xsl:value-of select="timestamp"/></td>
	<td><xsl:value-of select="vfs_func"/></td>
	<td><xsl:value-of select="user"/></td>
	<td><xsl:value-of select="file"/></td>
	<td><xsl:value-of select="domain"/></td>
	<td><xsl:value-of select="value"/></td>
	<td><xsl:value-of select="comment"/></td>
	<td><xsl:value-of select="file2"/></td>
	</tr>
</xsl:template>

<xsl:template match="top">
	<h2>
	<xsl:value-of select="description"/>
	</h2>
	<table border="1" with="100%">
	<tr>
	<th>Position</th>
	<th>Object name</th>
	<th>Value</th>
	</tr>
	<xsl:apply-templates select="toprow">
	</xsl:apply-templates>
	</table>
</xsl:template>

<xsl:template match="toprow">
	<tr>
	<td><xsl:value-of select="num"/></td>
	<td><xsl:value-of select="object"/></td>
	<td><xsl:value-of select="value"/></td>
	</tr>
</xsl:template>

<xsl:template match="footer">
	<br/>
	<hr/>
	<p align="right">
	<a href="{homepage}"><xsl:value-of select="application"/></a> Version <xsl:value-of select="version"/>, <xsl:value-of select="timestamp"/>
	</p>
</xsl:template>

<xsl:template match="list">
	<h2>
	<xsl:value-of select="description"/>
	</h2>
	<table border="1" with="100%">
	<tr>
	<xsl:for-each select="header_element">
	<th><xsl:value-of select="."/></th>
	</xsl:for-each>
	</tr>
	<xsl:for-each select="table_row">
		<tr>
		<xsl:for-each select="table_value">
			<td><xsl:value-of select="."/>
			</td>
		</xsl:for-each>
		</tr>
	</xsl:for-each>
	</table>
</xsl:template>


<xsl:template match="search">
<h2>
<xsl:value-of select="title"/> at <xsl:value-of select="timestamp"/>
</h2>
<xsl:for-each select="result">
<xsl:for-each select="user"><xsl:value-of select="name"/> is a user, in domain <xsl:value-of select="domain"/>.<br/>
</xsl:for-each>
<xsl:for-each select="file"><xsl:value-of select="name"/> is a file, on share <xsl:value-of select="share"/> in domain <xsl:value-of select="domain"/>.<br/>
</xsl:for-each>
<xsl:for-each select="sid"><xsl:value-of select="name"/> is a SID, belonging to user <xsl:value-of select="user"/> in domain <xsl:value-of select="domain"/>.<br/>
</xsl:for-each>
<xsl:for-each select="domain"><xsl:value-of select="name"/> is a domain.<br/>
</xsl:for-each>
</xsl:for-each>
</xsl:template>

<xsl:template match="throughput">
<h2>
<xsl:value-of select="title"/>
</h2>
<br/>
<xsl:value-of select="throughput_value"/>
<br/>
</xsl:template>



<xsl:template match="total">
	<p>
	<h2>
	<xsl:value-of select="description"/>
	</h2>
	<xsl:value-of select="totalvalue"/>
	</p>
</xsl:template>

</xsl:stylesheet>
