<xsl:stylesheet 
  version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns="http://www.w3.org/1999/xhtml">

<xsl:output method="xml" encoding="UTF-8"/>

<xsl:template match="usage">
	<xsl:value-of select="description"/>
|Time		|DataFlow		|Percent
------------------------------------------------------------------------------
<xsl:apply-templates select="usagerow">
</xsl:apply-templates>
</xsl:template>

<xsl:template match="usagerow">
<xsl:value-of select="time"/>	|<xsl:value-of select="convval"/>		|<xsl:value-of select="percent"/>%
</xsl:template>

<xsl:template match="last_activity">
	<xsl:value-of select="description"/>
Comment
------------------------------------------------------------------------------
<xsl:apply-templates select="last_activityrow">
</xsl:apply-templates>
</xsl:template>

<xsl:template match="last_activityrow">
<xsl:value-of select="comment"/>|
</xsl:template>


<xsl:template match="top">
<xsl:value-of select="description"/>
|Pos		|Value		|Object
------------------------------------------------------------------------------
<xsl:apply-templates select="toprow">
</xsl:apply-templates>
</xsl:template>

<xsl:template match="toprow">
|<xsl:value-of select="num"/>		|<xsl:value-of select="value"/>	|<xsl:value-of select="object"/>
</xsl:template>

<xsl:template match="list">
<xsl:value-of select="description"/>
|<xsl:for-each select="header_element"><xsl:value-of select="."/> , </xsl:for-each>
------------------------------------------------------------------------------
<xsl:for-each select="table_row">
|<xsl:for-each select="table_value"><xsl:value-of select="."/> , </xsl:for-each>

</xsl:for-each>
        
</xsl:template>

<xsl:template match="search">
<xsl:value-of select="title"/> at <xsl:value-of select="timestamp"/>
------------------------------------------------------------------------------
<xsl:for-each select="result">
<xsl:for-each select="share"><xsl:value-of select="name"/> is a share, in domain <xsl:value-of select="domain"/>.
</xsl:for-each>
<xsl:for-each select="user"><xsl:value-of select="name"/> is a user, in domain <xsl:value-of select="domain"/>.
</xsl:for-each>
<xsl:for-each select="file"><xsl:value-of select="name"/> is a file, on share <xsl:value-of select="share"/> in domain <xsl:value-of select="domain"/>.
</xsl:for-each>
<xsl:for-each select="sid"><xsl:value-of select="name"/> is a SID, belonging to user <xsl:value-of select="user"/> in domain <xsl:value-of select="domain"/>.
</xsl:for-each>
<xsl:for-each select="domain"><xsl:value-of select="name"/> is a domain.
</xsl:for-each>
</xsl:for-each>
</xsl:template>

<xsl:template match="footer">
------------------------------------------------------------------------------
SMB Traffic Analyzer <xsl:value-of select="version"/>, <xsl:value-of select="timestamp"/>
</xsl:template>

</xsl:stylesheet>
